#!/usr/bin/env python3
"""
fetch_by_isin.py

Fetches and prints the most recent closing price of an ETF using its ISIN.
"""

import yfinance as yf
from moneyed import Money, EUR

def main():
    # 1. Specify the ETF by ISIN
    isin = "icga.mu"    # iShares Core MSCI World UCITS ETF (Acc)

    # 2. Create a yfinance Ticker using the ISIN
    etf = yf.Ticker(isin)

    # 3. Fetch 1-day history to get the last close price
    df = etf.history(period="1d")
    if df.empty:
        print(f"‚ùó No data found for ISIN {isin}")
        return

    # 4. Extract closing price and wrap in Money
    last_close = df["Close"].iloc[-1]
    price = Money(last_close, EUR)

    # 5. Print the result
    print(f"ETF (ISIN: {isin}) latest closing price: {price}")

if __name__ == "__main__":
    main()
